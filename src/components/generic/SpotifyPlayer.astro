<div class="spotify-container">
  <h2 class="text-2xl md:text-4xl lg:text-6xl mb-4 dm-serif">
    What I'm listening to
  </h2>

  <div class="spotify-content">
    <div class="current-album mb-6">
      <iframe
        id="spotify-frame"
        width="100%"
        height="352"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
        loading="lazy"
        style="border: 0; border-radius:12px"
      ></iframe>
    </div>
  </div>
</div>

<script>
  type Album = { id: string };

  const albums: Album[] = [
    { id: '3hKlec1wgYVJcI0YvwCFJB' },
    { id: '5PKfMfQxsoapso8E9zu1A2' },
    { id: '1QZJzByKliJB2xyhgrYk4j' },
    { id: '3g4koxypokRF6kR3KA5F0P' },
    { id: '0U0Qv2jYtsgGxFDpQJKAxQ' },
    { id: '5QGv6b6i7tIOksucTpcUau' },
  ];

  const CYCLE_MS = 8000;

  const setAlbum = (index: number) => {
    const frame = document.getElementById('spotify-frame') as HTMLIFrameElement | null;
    const album = albums[index % albums.length];
    if (!frame || !album) return;
    frame.src = `https://open.spotify.com/embed/album/${album.id}?utm_source=generator`;
  };

  document.addEventListener('DOMContentLoaded', () => {
    let currentIndex = 0;
    setAlbum(currentIndex);

    if (albums.length > 1) {
      setInterval(() => {
        currentIndex = (currentIndex + 1) % albums.length;
        setAlbum(currentIndex);
      }, CYCLE_MS);
    }
  });
</script>

<style>
  .spotify-container {
    width: 100%;
  }

  .spotify-content {
    width: 100%;
  }

  .current-album {
    position: relative;
  }
</style>
